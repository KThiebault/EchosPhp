{% extends 'base.html.twig' %}

{% block body %}
    {% for key, tag in tags %}
        {% if key == 2 and histories is not empty %}
            <section class="mb-6 mx-4">
                <h3 class="font-bold text-2xl text-gray-700 mb-3">Last reading</h3>
                <div class="flex flex-wrap gap-4">
                    {% for history in histories %}
                        <article class="rounded-lg drop-shadow-lg bg-white py-3 px-4">
                            <header class="mb-2">
                                <a href="{{ path('app_book_read', {book_uuid: history.book.uuid, chapter_uuid: history.chapter.uuid}) }}" class="font-semibold text-lg text-gray-600">
                                    {{ history.book.title }}
                                </a>
                            </header>
                            <main class="mb-2">
                                {{ history.book.summary }}
                            </main>
                            <footer class="text-gray-500 text-sm">
                                {% for tag in history.book.tags %}
                                    <a href="{{ path('app_tag_show', {tag_uuid: tag.uuid}) }}" class="hover:underline">{{ tag.name }}</a>
                                {% endfor %}
                            </footer>
                        </article>
                    {% endfor %}
                </div>
            </section>
        {% endif %}
        {% if tag.books|length >= 1 %}
            <section class="mb-6 mx-4">
                <h2 class="font-bold text-2xl text-gray-700 mb-3">{{ tag.name }}</h2>
                <div class="flex flex-wrap gap-4">
                    {% for book in tag.books %}
                        <article class="rounded-lg drop-shadow-lg bg-white py-3 px-4">
                            <header class="mb-2">
                                <a href="{{ path('app_book_show', {book_uuid: book.uuid}) }}" class="font-semibold text-lg text-gray-600">
                                    {{ book.title }}
                                </a>
                            </header>
                            <main class="mb-2">
                                {{ book.summary }}
                            </main>
                            <footer class="text-gray-500 text-sm">
                                {% for tag in book.tags %}
                                    <a href="{{ path('app_tag_show', {tag_uuid: tag.uuid}) }}" class="hover:underline">{{ tag.name }}</a>
                                {% endfor %}
                            </footer>
                        </article>
                    {% endfor %}
                </div>
            </section>
        {% endif %}
    {% endfor %}
{% endblock %}